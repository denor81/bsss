# Инструкция по созданию и публикации архива

## Создание архива

Для создания архива с проектом выполните следующие команды:

```bash
# Шаг 1: Создаём архив локально
VERSION="1.0.0"

# Вариант 1: Используйте готовый скрипт (рекомендуется)
./build-archive.sh ${VERSION}

# Вариант 2: Создайте архив вручную, явно указывая нужные файлы
tar -czf "project-v${VERSION}.tar.gz" \
    oneline-runner.sh \
    local-runner.sh \
    bsss-main.sh \
    modules/

# Шаг 2: Создаём тег в Git
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin v1.0.0

# Шаг 3: Публикуем на GitHub
gh release create v1.0.0 "project-v${VERSION}.tar.gz" --title "Release v${VERSION}"

# Шаг 4: Обновляем oneline-runner.sh в репозитории
git add oneline-runner.sh
git commit -m "Update oneline-runner.sh with correct archive URL format"
git push origin main
```

## Запуск через oneline

Для запуска проекта используйте команду:

```bash
bash <(curl -fsSL https://raw.githubusercontent.com/denor81/bsss/main/oneline-runner.sh)
```

Скрипт автоматически определит последний релиз и скачает соответствующий архив.

## Установка и использование

### Запуск через oneline

При запуске скрипт предложит выбор режима:
```bash
bash <(curl -fsSL https://raw.githubusercontent.com/denor81/bsss/main/oneline-runner.sh)
```

Диалог выбора режима:
- **Y** - запустить однократно (по умолчанию)
- **n** - установить в систему
- **c** - отмена

### Установка в систему

При выборе режима установки скрипт:
1. Проверяет наличие зависимостей (curl, tar)
2. Устанавливает файлы в `/opt/bsss/`
3. Создаёт символическую ссылку `/usr/local/bin/bsss`
4. Создаёт скрипт удаления `/opt/bsss/uninstall.sh`

Для запуска установленной версии:
```bash
sudo bsss [параметры]
```

### Удаление из системы

Для полного удаления программы есть два способа:

**Способ 1 (рекомендуемый, только при установленном скрипте):**
```bash
sudo bsss --uninstall
```

**Способ 2:**
```bash
sudo /opt/bsss/uninstall.sh
```

Скрипт удаления удалит:
- Директорию `/opt/bsss/` со всеми файлами
- Символическую ссылку `/usr/local/bin/bsss`

## Структура архива

Архив должен содержать следующие файлы и директории:
- `oneline-runner.sh` - скрипт загрузки и запуска
- `local-runner.sh` - локальный скрипт запуска
- `bsss-main.sh` - основной скрипт проекта
- `modules/` - модули проекта со всеми вложенными файлами и директориями

## Важное замечание

При публикации нового релиза убедитесь, что `oneline-runner.sh` в основной ветке репозитория уже обновлён и умеет работать с новым форматом имени архива. В противном случае пользователи не смогут скачать и запустить последнюю версию.

## Правила формирования архива

В архив включаются только следующие файлы и директории:
- `oneline-runner.sh` - скрипт загрузки и запуска
- `local-runner.sh` - локальный скрипт запуска
- `bsss-main.sh` - основной скрипт проекта
- `modules/` - модули проекта со всеми вложенными файлами и директориями

Все остальные файлы и директории в проекте не включаются в архив. Это обеспечивает минимальный размер дистрибутива и исключает попадание служебных файлов.