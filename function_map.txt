run_modules_polling()<:>Orchestrator<:>Поиск и запуск модулей с типом 'check'<:>./bsss-main.sh
orchestrator::select_modify_module()<:>Filter<:>Отображает нумерованное меню модулей для выбора<:>./bsss-main.sh
run_modules_modify()<:>Orchestrator<:>Поиск и запуск модулей с типом 'modify' в циклическом меню<:>./bsss-main.sh
main()<:>Orchestrator<:>Основная точка входа<:>./bsss-main.sh
main()<:>Orchestrator<:>Создает архив проекта<:>./build-archive.sh
find_bash_files()<:>Source<:>Находит все bash файлы в проекте<:>./generate_function_map.sh
extract_functions_from_file()<:>Filter<:>Извлекает функции и их контракты из bash файла<:>./generate_function_map.sh
main()<:>Orchestrator<:>Основная точка входа для генерации карты функций<:>./generate_function_map.sh
log::new_line()<:>Sink<:>Новая строка<:>./lib/logging.sh
log_success()<:>Sink<:>Выводит успешное сообщение с символом [v]<:>./lib/logging.sh
log_error()<:>Sink<:>Выводит сообщение об ошибке с символом [x]<:>./lib/logging.sh
log_info()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./lib/logging.sh
log_bold_info()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./lib/logging.sh
log_warn()<:>Sink<:>Выводит предупреждение с символом [!]<:>./lib/logging.sh
log_attention()<:>Sink<:>Выводит важное сообщение с символом [A]<:>./lib/logging.sh
log_actual_info()<:>Sink<:>Выводит важное сообщение с символом [i]<:>./lib/logging.sh
log_info_simple_tab()<:>Sink<:>Выводит информационное сообщение с отступом<:>./lib/logging.sh
log_start()<:>Sink<:>Выводит информационное сообщение о запуске процесса<:>./lib/logging.sh
log_stop()<:>Sink<:>Выводит информационное сообщение о остановке процесса<:>./lib/logging.sh
log::draw_border()<:>Sink<:>Выводит разделитель из 80 символов '#'<:>./lib/logging.sh
log::draw_lite_border()<:>Sink<:>Выводит разделитель из 80 символов '-'<:>./lib/logging.sh
check_uninstall_file()<:>Filter<:>Проверяет наличие файла с путями для удаления<:>./lib/uninstall_functions.sh
do_uninstall()<:>Orchestrator<:>Выполняет удаление файлов из файла лога<:>./lib/uninstall_functions.sh
run_uninstall()<:>Orchestrator<:>Запускает процесс удаления с подтверждением<:>./lib/uninstall_functions.sh
io::ask_value()<:>Interactive<:>Циклический опрос пользователя до получения валидного значения.<:>./lib/user_confirmation.sh
io::confirm_action()<:>Validator<:>Ждет подтверждение действия. Доступны только y или n<:>./lib/user_confirmation.sh
parse_params()<:>Filter<:>Парсинг параметров запуска с использованием getopts<:>./local-runner.sh
check_permissions()<:>Filter<:>Проверяет права доступа для запуска скрипта<:>./local-runner.sh
show_help()<:>Sink<:>Выводит справочную информацию<:>./local-runner.sh
run_default()<:>Orchestrator<:>Запускает основной скрипт<:>./local-runner.sh
main()<:>Orchestrator<:>Основная точка входа<:>./local-runner.sh
_get_os_id()<:>Filter<:>Получает строку ID текущей системы<:>./modules/01-os-check.sh
check()<:>Orchestrator<:>Проверяет совместимость текущей ОС с разрешенной<:>./modules/01-os-check.sh
sys::get_update_command()<:>Source<:>Генерирует команду обновления системы для apt<:>./modules/02-update-system.sh
sys::execute_update()<:>Sink<:>Выполняет обновление системы используя переданную команду<:>./modules/02-update-system.sh
sys::update_system()<:>Orchestrator<:>Оркестратор процесса обновления системы<:>./modules/02-update-system.sh
main()<:>Orchestrator<:>Основная точка входа модуля обновления системы<:>./modules/02-update-system.sh
check()<:>Orchestrator<:>Проверяет режим запуска SSH и переключает на service если нужно<:>./modules/03-ssh-socket-check.sh
make_fifo_and_start_reader()<:>Orchestrator<:>Создает FIFO и запускает слушатель для коммуникации с rollback<:>./modules/03-ssh-socket-check.sh
stop_script_by_rollback_timer()<:>Orchestrator<:>Обработчик сигнала SIGUSR1 - останавливает скрипт при откате<:>./modules/03-ssh-socket-check.sh
orchestrator::watchdog_start()<:>Orchestrator<:>Запускает фоновый процесс rollback (watchdog)<:>./modules/03-ssh-socket-check.sh
orchestrator::watchdog_stop()<:>Orchestrator<:>Останавливает процесс rollback (watchdog) по PID<:>./modules/03-ssh-socket-check.sh
orchestrator::guard_ui_instructions()<:>Sink<:>Отображает инструкции пользователю для проверки подключения<:>./modules/03-ssh-socket-check.sh
orchestrator::switch_to_service_with_guard()<:>Orchestrator<:>Переключает SSH на service с механизмом отката<:>./modules/03-ssh-socket-check.sh
ssh::is_socket_mode()<:>Filter<:>Проверяет, активен ли ssh.socket (socket-активация)<:>./modules/03-ssh-socket-helpers.sh
ssh::is_service_mode()<:>Filter<:>Проверяет, активен ли ssh.service<:>./modules/03-ssh-socket-helpers.sh
ssh::switch_to_service_mode()<:>Orchestrator<:>Переключает SSH с socket на service режим<:>./modules/03-ssh-socket-helpers.sh
ssh::switch_to_socket_mode()<:>Orchestrator<:>Переключает SSH с service на socket режим<:>./modules/03-ssh-socket-helpers.sh
check()<:>Orchestrator<:>Проверяет необходимость перезагрузки системы<:>./modules/03-sys-reload-check.sh
check()<:>Orchestrator<:>Проверяет состояние SSH портов и правил<:>./modules/04-ssh-port-check.sh
ssh::install_new_port()<:>Filter<:>Основной функционал установки/изменения SSH порта<:>./modules/04-ssh-port-helpers.sh
ssh::get_user_choice()<:>Source<:>Запрашивает у пользователя новый SSH порт<:>./modules/04-ssh-port-helpers.sh
ssh::log_bsss_configs_w_port()<:>Orchestrator<:>Выводит все BSSS конфигурации SSH с портами<:>./modules/04-ssh-port-helpers.sh
ssh::log_other_configs_w_port()<:>Orchestrator<:>Выводит все сторонние конфигурации SSH с портами<:>./modules/04-ssh-port-helpers.sh
orchestrator::actions_after_port_change()<:>Orchestrator<:>Выполняет действия после установки порта: перезапуск сервисов и валидация<:>./modules/04-ssh-port-helpers.sh
ssh::reset_and_pass()<:>Filter<:>Удаляет все правила BSSS и передает порт дальше<:>./modules/04-ssh-port-helpers.sh
ssh::delete_all_bsss_rules()<:>Orchestrator<:>Удаляет все правила BSSS SSH<:>./modules/04-ssh-port-helpers.sh
sys::restart_services()<:>Orchestrator<:>Перезапускает SSH сервис после проверки конфигурации<:>./modules/04-ssh-port-helpers.sh
ssh::is_port_busy()<:>Filter<:>Проверяет, занят ли указанный порт<:>./modules/04-ssh-port-helpers.sh
ssh::generate_free_random_port()<:>Source<:>Генерирует случайный свободный порт в диапазоне 10000-65535<:>./modules/04-ssh-port-helpers.sh
ssh::create_bsss_config_file()<:>Filter<:>Создает новый конфигурационный файл SSH с указанным портом<:>./modules/04-ssh-port-helpers.sh
ssh::display_menu()<:>Sink<:>Отображает пункты меню пользователю<:>./modules/04-ssh-port-helpers.sh
ssh::apply_changes()<:>Filter<:>Применяет изменения SSH порта (сброс старых правил и установка новых)<:>./modules/04-ssh-port-helpers.sh
ssh::confirm_success()<:>Filter<:>Запрашивает подтверждение успешного подключения<:>./modules/04-ssh-port-helpers.sh
ssh::wait_for_port_up()<:>Filter<:>Блокирующая проверка поднятия SSH порта после изменения<:>./modules/04-ssh-port-helpers.sh
orchestrator::dispatch_logic()<:>Orchestrator<:>Определяет состояние конфигурации SSH (существует/отсутствует)<:>./modules/04-ssh-port-modify.sh
orchestrator::bsss_config_exists()<:>Orchestrator<:>Интерфейс выбора действий при наличии существующих конфигов<:>./modules/04-ssh-port-modify.sh
orchestrator::bsss_config_not_exists()<:>Orchestrator<:>Обработчик сценария отсутствия конфигурации SSH<:>./modules/04-ssh-port-modify.sh
orchestrator::install_new_port_w_guard()<:>Orchestrator<:>Запускает модуль SSH с механизмом rollback<:>./modules/04-ssh-port-modify.sh
check()<:>Orchestrator<:>Проверяет наличие UFW и устанавливает при необходимости<:>./modules/05-ufw-check.sh
ufw::get_menu_items()<:>Source<:>Генерирует список доступных пунктов меню на основе текущего состояния<:>./modules/05-ufw-helpers.sh
ufw::display_menu()<:>Sink<:>Отображает пункты меню пользователю (вывод только в stderr)<:>./modules/05-ufw-helpers.sh
ufw::get_user_choice()<:>Source<:>Запрашивает выбор пользователя и возвращает выбранный ID<:>./modules/05-ufw-helpers.sh
ufw::execute_action()<:>Orchestrator<:>Выполняет выбранное действие на основе ID<:>./modules/05-ufw-helpers.sh
ufw::toggle()<:>Sink<:>Переключает состояние UFW<:>./modules/05-ufw-helpers.sh
ufw::log_status()<:>Sink<:>Логирует состояние UFW<:>./modules/05-ufw-helpers.sh
orchestrator::actions_after_ufw_change()<:>Orchestrator<:>Выполняет действия после установки порта: перезапуск сервисов и валидация<:>./modules/05-ufw-helpers.sh
ufw::apply_changes()<:>Filter<:>Применяет изменения UFW на основе выбранного действия<:>./modules/05-ufw-helpers.sh
ufw::confirm_success()<:>Filter<:>Запрашивает подтверждение успешной работы UFW<:>./modules/05-ufw-helpers.sh
orchestrator::run_ufw_module()<:>Orchestrator<:>Запускает модуль UFW с механизмом rollback<:>./modules/05-ufw-modify.sh
make_fifo_and_start_reader()<:>Orchestrator<:>Создает FIFO и запускает слушатель для коммуникации с rollback<:>./modules/05-ufw-modify.sh
stop_script_by_rollback_timer()<:>Orchestrator<:>Обработчик сигнала SIGUSR1 - останавливает скрипт при откате<:>./modules/05-ufw-modify.sh
orchestrator::watchdog_start()<:>Orchestrator<:>Запускает фоновый процесс rollback (watchdog)<:>./modules/05-ufw-modify.sh
orchestrator::watchdog_stop()<:>Orchestrator<:>Останавливает процесс rollback (watchdog) по PID<:>./modules/05-ufw-modify.sh
orchestrator::guard_ui_instructions()<:>Sink<:>Отображает инструкции пользователю для проверки подключения<:>./modules/05-ufw-modify.sh
main()<:>Orchestrator<:>Основная точка входа для модуля изменения состояния UFW<:>./modules/05-ufw-modify.sh
sys::get_paths_by_mask()<:>Source<:>Получает список путей через нулевой разделитель<:>./modules/common-helpers.sh
sys::get_modules_paths_w_type<:>Filter<:>Возвращает строку - путь с типом<:>./modules/common-helpers.sh
sys::get_modules_by_type<:>Filter<:>Возвращает отфильтрованные по типу пути к модулям<:>./modules/common-helpers.sh
sys::delete_paths()<:>Filter<:>Удаляет указанные файлы и директории<:>./modules/common-helpers.sh
ssh::get_ports_from_ss()<:>Source<:>Получает активные SSH порты из ss<:>./modules/common-helpers.sh
ssh::get_first_port_from_path()<:>Filter<:>Получает первый порт из path<:>./modules/common-helpers.sh
ssh::log_active_ports_from_ss()<:>Orchestrator<:>Проверяет возможность определения активных портов<:>./modules/common-helpers.sh
ufw::log_active_ufw_rules()<:>Orchestrator<:>Выводит активные правила UFW<:>./modules/common-helpers.sh
ufw::reset_and_pass()<:>Filter<:>Удаляет все правила UFW BSSS и передает порт дальше<:>./modules/common-helpers.sh
ufw::delete_all_bsss_rules()<:>Orchestrator<:>Удаляет все правила UFW BSSS<:>./modules/common-helpers.sh
ufw::get_all_bsss_rules()<:>Source<:>Получает все правила UFW BSSS<:>./modules/common-helpers.sh
ufw::get_all_rules()<:>Source<:>Получает все правила UFW<:>./modules/common-helpers.sh
ufw::add_bsss_rule()<:>Filter<:>Добавляет правило UFW для BSSS<:>./modules/common-helpers.sh
ufw::is_active()<:>Filter<:>Проверяет, активен ли UFW<:>./modules/common-helpers.sh
ufw::force_disable()<:>Filter<:>Деактивирует UFW (пропускает если уже деактивирован)<:>./modules/common-helpers.sh
ufw::enable()<:>Filter<:>Активирует UFW<:>./modules/common-helpers.sh
sys::validate_sshd_config()<:>Filter<:>Проверяет конфигурацию sshd на валидность<:>./modules/common-helpers.sh
is_sourced()<:>Filter<:>Проверяет, был ли скрипт вызван через source<:>./oneline-runner.sh
log_success()<:>Sink<:>Выводит успешное сообщение с символом [V]<:>./oneline-runner.sh
log_error()<:>Sink<:>Выводит сообщение об ошибке с символом [X]<:>./oneline-runner.sh
log_info()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./oneline-runner.sh
cleanup_handler()<:>Orchestrator<:>Очистка временных файлов<:>./oneline-runner.sh
hello()<:>Sink<:>Выводит приветственное сообщение<:>./oneline-runner.sh
check_root_permissions()<:>Filter<:>Проверяет права root<:>./oneline-runner.sh
_create_tmp_dir()<:>Source<:>Создаёт временную директорию<:>./oneline-runner.sh
_download_archive()<:>Source<:>Скачивает архив во временный файл<:>./oneline-runner.sh
_unpack_archive()<:>Filter<:>Распаковывает архив<:>./oneline-runner.sh
_check_archive_unpacking()<:>Filter<:>Проверяет успешность распаковки во временную директорию<:>./oneline-runner.sh
_add_uninstall_path()<:>Sink<:>Добавляет путь в файл лога установки для последующего удаления<:>./oneline-runner.sh
_check_symlink_exists()<:>Filter<:>Проверяет наличие символической ссылки<:>./oneline-runner.sh
_create_install_directory()<:>Orchestrator<:>Создание директории установки<:>./oneline-runner.sh
_copy_installation_files()<:>Orchestrator<:>Копирование файлов установки<:>./oneline-runner.sh
_create_symlink()<:>Orchestrator<:>Создание символической ссылки<:>./oneline-runner.sh
_set_execution_permissions()<:>Orchestrator<:>Установка прав на выполнение<:>./oneline-runner.sh
install_to_system()<:>Orchestrator<:>Функция установки в систему<:>./oneline-runner.sh
main()<:>Orchestrator<:>Основная точка входа<:>./oneline-runner.sh
orchestrator::stop_rollback()<:>Orchestrator<:>Останавливает процесс таймера отката и завершает скрипт<:>./utils/rollback.sh
orchestrator::immediate_rollback()<:>Orchestrator<:>Немедленно выполняет тотальный откат при получении SIGUSR2<:>./utils/rollback.sh
orchestrator::ssh_rollback()<:>Orchestrator<:>Полный откат для SSH модуля - сброс правил SSH и отключение UFW<:>./utils/rollback.sh
orchestrator::ufw_rollback()<:>Orchestrator<:>Простой откат для UFW модуля - только отключение UFW<:>./utils/rollback.sh
orchestrator::ssh_socket_rollback()<:>Orchestrator<:>Откат SSH на socket режим<:>./utils/rollback.sh
orchestrator::rollback()<:>Orchestrator<:>Полная очистка системы от следов BSSS и деактивация UFW.<:>./utils/rollback.sh
orchestrator::watchdog_timer()<:>Orchestrator<:>Таймер для автоматического отката<:>./utils/rollback.sh
main()<:>Orchestrator<:>Основная точка входа<:>./utils/rollback.sh
ssh::reset_failed_services()<:>Filter<:>Сбрасывает счетчики ошибок сервисов systemd<:>./utils/test-ssh-modes.sh
show_current_mode()<:>Orchestrator<:>Отображает текущий режим SSH<:>./utils/test-ssh-modes.sh
switch_to_socket()<:>Orchestrator<:>Переключает на socket режим<:>./utils/test-ssh-modes.sh
switch_to_service()<:>Orchestrator<:>Переключает на service режим<:>./utils/test-ssh-modes.sh
reset_failed()<:>Orchestrator<:>Сбрасывает счетчики ошибок<:>./utils/test-ssh-modes.sh
validate_sshd()<:>Orchestrator<:>Валидация конфигурации sshd<:>./utils/test-ssh-modes.sh
