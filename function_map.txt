runner::module::run_check()<:>Orchestrator<:>Поиск и запуск модулей с типом 'check'<:>./bsss-main.sh
runner::module::select_modify()<:>Filter<:>Отображает нумерованное меню модулей для выбора<:>./bsss-main.sh
runner::module::run_modify()<:>Orchestrator<:>Поиск и запуск модулей с типом 'modify' в циклическом меню<:>./bsss-main.sh
main()<:>Orchestrator<:>Основная точка входа<:>./bsss-main.sh
main()<:>Orchestrator<:>Создает архив проекта<:>./build-archive.sh
log::new_line()<:>Sink<:>Новая строка<:>./lib/logging.sh
log_success()<:>Sink<:>Выводит успешное сообщение с символом [v]<:>./lib/logging.sh
log_error()<:>Sink<:>Выводит сообщение об ошибке с символом [x]<:>./lib/logging.sh
log_info()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./lib/logging.sh
log_debug()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./lib/logging.sh
log_bold_info()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./lib/logging.sh
log_warn()<:>Sink<:>Выводит предупреждение с символом [!]<:>./lib/logging.sh
log_attention()<:>Sink<:>Выводит важное сообщение с символом [A]<:>./lib/logging.sh
log_actual_info()<:>Sink<:>Выводит важное сообщение с символом [i]<:>./lib/logging.sh
log_info_simple_tab()<:>Sink<:>Выводит информационное сообщение с отступом<:>./lib/logging.sh
log_start()<:>Sink<:>Выводит информационное сообщение о запуске процесса<:>./lib/logging.sh
log_stop()<:>Sink<:>Выводит информационное сообщение о остановке процесса<:>./lib/logging.sh
log::draw_border()<:>Sink<:>Выводит разделитель из 80 символов '#'<:>./lib/logging.sh
log::draw_lite_border()<:>Sink<:>Выводит разделитель из 80 символов '-'<:>./lib/logging.sh
check_uninstall_file()<:>Filter<:>Проверяет наличие файла с путями для удаления<:>./lib/uninstall_functions.sh
do_uninstall()<:>Orchestrator<:>Выполняет удаление файлов из файла лога<:>./lib/uninstall_functions.sh
run_uninstall()<:>Orchestrator<:>Запускает процесс удаления с подтверждением<:>./lib/uninstall_functions.sh
io::ask_value()<:>Interactive<:>Циклический опрос пользователя до получения валидного значения.<:>./lib/user_confirmation.sh
io::confirm_action()<:>Validator<:>Ждет подтверждение действия. Доступны только y или n<:>./lib/user_confirmation.sh
parse_params()<:>Filter<:>Парсинг параметров запуска с использованием getopts<:>./local-runner.sh
check_permissions()<:>Filter<:>Проверяет права доступа для запуска скрипта<:>./local-runner.sh
show_help()<:>Sink<:>Выводит справочную информацию<:>./local-runner.sh
run_default()<:>Orchestrator<:>Запускает основной скрипт<:>./local-runner.sh
main()<:>Orchestrator<:>Основная точка входа<:>./local-runner.sh
get_os_id()<:>Filter<:>Получает строку ID текущей системы<:>./modules/01-os-check.sh
check()<:>Orchestrator<:>Проверяет совместимость текущей ОС с разрешенной<:>./modules/01-os-check.sh
sys::update::get_command()<:>Source<:>Генерирует команду обновления системы для apt<:>./modules/02-update-system.sh
sys::update::execute()<:>Sink<:>Выполняет обновление системы используя переданную команду<:>./modules/02-update-system.sh
sys::update::orchestrator()<:>Orchestrator<:>Оркестратор процесса обновления системы<:>./modules/02-update-system.sh
main()<:>Orchestrator<:>Основная точка входа модуля обновления системы<:>./modules/02-update-system.sh
check()<:>Orchestrator<:>Настраивает SSH в service режим, если это необходимо<:>./modules/03-ssh-socket-check.sh
ssh::socket::is_already_configured()<:>Filter<:>Проверяет, настроен ли SSH в service mode<:>./modules/03-ssh-socket-helpers.sh
ssh::socket::force_service_mode()<:>Orchestrator<:>Принудительно переключает SSH в service mode<:>./modules/03-ssh-socket-helpers.sh
check()<:>Orchestrator<:>Проверяет необходимость перезагрузки системы<:>./modules/03-sys-reload-check.sh
check()<:>Orchestrator<:>Проверяет состояние SSH портов и правил<:>./modules/04-ssh-port-check.sh
ssh::menu::display_exists_scenario()<:>Sink<:>Отображает меню сценария с существующими конфигами<:>./modules/04-ssh-port-helpers.sh
ssh::menu::display_install_ui()<:>Sink<:>Отображает меню сценария установки<:>./modules/04-ssh-port-helpers.sh
ssh::port::install_new()<:>Filter<:>Основной функционал установки/изменения SSH порта<:>./modules/04-ssh-port-helpers.sh
ssh::ui::get_new_port()<:>Source<:>Запрашивает у пользователя новый SSH порт<:>./modules/04-ssh-port-helpers.sh
ssh::log::bsss_configs()<:>Sink<:>Логирует все BSSS конфигурации SSH с портами<:>./modules/04-ssh-port-helpers.sh
ssh::log::other_configs()<:>Sink<:>Логирует все сторонние конфигурации SSH с портами<:>./modules/04-ssh-port-helpers.sh
ssh::orchestrator::log_statuses()<:>Orchestrator<:>Выполняет действия после установки порта: перезапуск сервисов и валидация<:>./modules/04-ssh-port-helpers.sh
ssh::rule::reset_and_pass()<:>Filter<:>Удаляет все правила BSSS и передает порт дальше<:>./modules/04-ssh-port-helpers.sh
ssh::rule::delete_all_bsss()<:>Orchestrator<:>Удаляет все правила BSSS SSH<:>./modules/04-ssh-port-helpers.sh
ssh::port::is_port_free()<:>Source<:>Проверяет, что указанный порт свободен<:>./modules/04-ssh-port-helpers.sh
ssh::port::generate_free_random_port()<:>Source<:>Генерирует случайный свободный порт в диапазоне 10000-65535<:>./modules/04-ssh-port-helpers.sh
ssh::config::create_bsss_file()<:>Filter<:>Создает новый конфигурационный файл SSH с указанным портом<:>./modules/04-ssh-port-helpers.sh
ssh::port::wait_for_up()<:>Filter<:>Блокирующая проверка поднятия SSH порта после изменения<:>./modules/04-ssh-port-helpers.sh
ssh::orchestrator::config_exists_handler()<:>Orchestrator<:>Обработчик сценария с существующими конфигами<:>./modules/04-ssh-port-helpers.sh
ssh::orchestrator::config_not_exists_handler()<:>Orchestrator<:>Обработчик сценария отсутствия конфигов<:>./modules/04-ssh-port-helpers.sh
ssh::install::port()<:>Orchestrator<:>Устанавливает новый SSH порт с механизмом rollback<:>./modules/04-ssh-port-helpers.sh
ssh::reset::port()<:>Orchestrator<:>Сбрасывает SSH порт (удаляет все BSSS правила)<:>./modules/04-ssh-port-helpers.sh
ssh::log::guard_instructions()<:>Sink<:>Отображает инструкции guard для пользователя<:>./modules/04-ssh-port-helpers.sh
sys::service::restart()<:>Orchestrator<:>Перезапускает SSH сервис после проверки конфигурации<:>./modules/04-ssh-port-helpers.sh
ssh::orchestrator::dispatch_logic()<:>Orchestrator<:>Определяет состояние конфигурации SSH и переключает логику модуля на соответствующий сценарий<:>./modules/04-ssh-port-modify.sh
main()<:>Orchestrator<:>Основная точка входа для модуля изменения SSH порта<:>./modules/04-ssh-port-modify.sh
check()<:>Orchestrator<:>Проверяет наличие UFW и устанавливает при необходимости<:>./modules/05-ufw-check.sh
ufw::rule::has_any_bsss()<:>Filter<:>Проверяет, есть ли правила UFW BSSS<:>./modules/05-ufw-helpers.sh
ufw::rule::check_requirements()<:>Orchestrator<:>Проверяет требования для запуска UFW модуля<:>./modules/05-ufw-helpers.sh
ufw::menu::get_items()<:>Source<:>Генерирует список доступных пунктов меню на основе текущего состояния<:>./modules/05-ufw-helpers.sh
ufw::menu::display()<:>Sink<:>Отображает пункты меню пользователю (вывод только в stderr)<:>./modules/05-ufw-helpers.sh
ufw::menu::count_items()<:>Source<:>Считает количество пунктов меню (Корректно работает до 9 пунктов)<:>./modules/05-ufw-helpers.sh
ufw::menu::get_user_choice()<:>Source<:>Запрашивает выбор пользователя и возвращает выбранный ID<:>./modules/05-ufw-helpers.sh
ufw::orchestrator::dispatch_logic()<:>Orchestrator<:>Применяет изменения UFW на основе выбранного действия<:>./modules/05-ufw-helpers.sh
ufw::toggle::status()<:>Orchestrator<:>Переключает состояние UFW<:>./modules/05-ufw-helpers.sh
ufw::status::force_enable()<:>Orchestrator<:>Активирует UFW с watchdog и подтверждением подключения<:>./modules/05-ufw-helpers.sh
log::rollback::instructions()<:>Sink<:>Отображает инструкции пользователю для проверки подключения<:>./modules/05-ufw-helpers.sh
ufw::toggle::ping()<:>Orchestrator<:>Переключает состояние PING<:>./modules/05-ufw-helpers.sh
ufw::orchestrator::disable_ping()<:>Orchestrator<:>Отключает пинг через UFW (бэкап + трансформация + reload)<:>./modules/05-ufw-helpers.sh
ufw::log::status()<:>Sink<:>Логирует состояние UFW<:>./modules/05-ufw-helpers.sh
ufw::log::ping_status()<:>Sink<:>Логирует состояние PING<:>./modules/05-ufw-helpers.sh
ufw::orchestrator::log_statuses()<:>Orchestrator<:>Отображает статусы UFW: общее состояние, правила, состояние PING<:>./modules/05-ufw-helpers.sh
ufw::ping::is_configured()<:>Filter<:>Проверяет, существует ли бэкап файл настроек PING<:>./modules/05-ufw-helpers.sh
ufw::ping::backup_file()<:>Filter<:>Создает бэкап файла before.rules<:>./modules/05-ufw-helpers.sh
ufw::ping::disable_in_rules()<:>Transformer<:>Заменяет ACCEPT на DROP в ICMP правилах через<:>./modules/05-ufw-helpers.sh
ufw::ping::restore()<:>Filter<:>Восстанавливает файл before.rules из бэкапа и удаляет бэкап<:>./modules/05-ufw-helpers.sh
ufw::status::reload()<:>Sink<:>Выполняет ufw reload для применения изменений<:>./modules/05-ufw-helpers.sh
ufw::orchestrator::run_module()<:>Orchestrator<:>Запускает модуль UFW с механизмом rollback только при включении UFW<:>./modules/05-ufw-modify.sh
main()<:>Orchestrator<:>Основная точка входа для модуля изменения состояния UFW<:>./modules/05-ufw-modify.sh
sys::log::rotate_old_files()<:>Sink<:>Вращает лог-файлы - удаляет старые файлы если их больше MAX_LOG_FILES<:>./modules/common-helpers.sh
sys::file::get_paths_by_mask()<:>Source<:>Получает список путей через нулевой разделитель<:>./modules/common-helpers.sh
sys::module::get_paths_w_type<:>Filter<:>Возвращает строку - путь с типом и порядком запуска<:>./modules/common-helpers.sh
sys::module::get_by_type<:>Filter<:>Возвращает отфильтрованные по типу пути к модулям<:>./modules/common-helpers.sh
sys::module::sort_by_order()<:>Filter<:>Сортирует пути модулей по приоритету MODULE_ORDER и извлекает только пути<:>./modules/common-helpers.sh
sys::module::validate_order()<:>Source<:>Валидирует наличие обязательного метатега MODULE_ORDER во всех модулях с MODULE_TYPE<:>./modules/common-helpers.sh
sys::module::check_duplicate_order()<:>Source<:>Проверяет дубликаты значений MODULE_ORDER в модулях<:>./modules/common-helpers.sh
sys::file::delete()<:>Filter<:>Удаляет указанные файлы и директории<:>./modules/common-helpers.sh
ssh::port::get_from_ss()<:>Source<:>Получает активные SSH порты из ss<:>./modules/common-helpers.sh
ssh::port::get_first_from_path()<:>Filter<:>Получает первый порт из path<:>./modules/common-helpers.sh
ssh::log::active_ports_from_ss()<:>Orchestrator<:>Проверяет возможность определения активных портов<:>./modules/common-helpers.sh
ufw::log::rules()<:>Orchestrator<:>Выводит активные правила UFW<:>./modules/common-helpers.sh
ufw::rule::reset_and_pass()<:>Filter<:>Удаляет все правила UFW BSSS и передает порт дальше<:>./modules/common-helpers.sh
ufw::rule::delete_all_bsss()<:>Orchestrator<:>Удаляет все правила UFW BSSS<:>./modules/common-helpers.sh
ufw::rule::get_all_bsss()<:>Source<:>Получает все правила UFW BSSS<:>./modules/common-helpers.sh
ufw::rule::get_all()<:>Source<:>Получает все правила UFW<:>./modules/common-helpers.sh
ufw::rule::add_bsss()<:>Filter<:>Добавляет правило UFW для BSSS<:>./modules/common-helpers.sh
ufw::status::is_active()<:>Filter<:>Проверяет, активен ли UFW<:>./modules/common-helpers.sh
ufw::status::force_disable()<:>Filter<:>Деактивирует UFW (пропускает если уже деактивирован)<:>./modules/common-helpers.sh
rollback::orchestrator::watchdog_start()<:>Orchestrator<:>Запускает фоновый процесс rollback (watchdog)<:>./modules/common-helpers.sh
rollback::orchestrator::watchdog_stop()<:>Orchestrator<:>Останавливает процесс rollback (watchdog) по PID<:>./modules/common-helpers.sh
make_fifo_and_start_reader()<:>Orchestrator<:>Создает FIFO и запускает слушатель для коммуникации с rollback<:>./modules/common-helpers.sh
common::rollback::stop_script_by_rollback_timer()<:>Orchestrator<:>Обработчик сигнала SIGUSR1 - останавливает модуль при откате и удаляем fifo<:>./modules/common-helpers.sh
common::exit::actions()<:>Orchestrator<:>Обработчик сигнала EXIT - останавливает модуль и удаляем fifo<:>./modules/common-helpers.sh
is_sourced()<:>Filter<:>Проверяет, был ли скрипт вызван через source<:>./oneline-runner.sh
log_success()<:>Sink<:>Выводит успешное сообщение с символом [V]<:>./oneline-runner.sh
log_error()<:>Sink<:>Выводит сообщение об ошибке с символом [X]<:>./oneline-runner.sh
log_info()<:>Sink<:>Выводит информационное сообщение с символом [ ]<:>./oneline-runner.sh
cleanup_handler()<:>Orchestrator<:>Очистка временных файлов<:>./oneline-runner.sh
hello()<:>Sink<:>Выводит приветственное сообщение<:>./oneline-runner.sh
check_root_permissions()<:>Filter<:>Проверяет права root<:>./oneline-runner.sh
_create_tmp_dir()<:>Source<:>Создаёт временную директорию<:>./oneline-runner.sh
_download_archive()<:>Source<:>Скачивает архив во временный файл<:>./oneline-runner.sh
_unpack_archive()<:>Filter<:>Распаковывает архив<:>./oneline-runner.sh
_check_archive_unpacking()<:>Filter<:>Проверяет успешность распаковки во временную директорию<:>./oneline-runner.sh
_add_uninstall_path()<:>Sink<:>Добавляет путь в файл лога установки для последующего удаления<:>./oneline-runner.sh
_check_symlink_exists()<:>Filter<:>Проверяет наличие символической ссылки<:>./oneline-runner.sh
_create_install_directory()<:>Orchestrator<:>Создание директории установки<:>./oneline-runner.sh
_copy_installation_files()<:>Orchestrator<:>Копирование файлов установки<:>./oneline-runner.sh
_create_symlink()<:>Orchestrator<:>Создание символической ссылки<:>./oneline-runner.sh
_set_execution_permissions()<:>Orchestrator<:>Установка прав на выполнение<:>./oneline-runner.sh
install_to_system()<:>Orchestrator<:>Функция установки в систему<:>./oneline-runner.sh
main()<:>Orchestrator<:>Основная точка входа<:>./oneline-runner.sh
find_bash_files()<:>Source<:>Находит все bash файлы в проекте<:>./utils/generate_function_map.sh
extract_functions_from_file()<:>Filter<:>Извлекает функции и их контракты из bash файла<:>./utils/generate_function_map.sh
main()<:>Orchestrator<:>Основная точка входа для генерации карты функций<:>./utils/generate_function_map.sh
rollback::orchestrator::stop()<:>Orchestrator<:>Останавливает процесс таймера отката и завершает скрипт<:>./utils/rollback.sh
rollback::orchestrator::immediate()<:>Orchestrator<:>Немедленно выполняет тотальный откат при получении SIGUSR2<:>./utils/rollback.sh
rollback::orchestrator::ssh()<:>Orchestrator<:>Полный откат для SSH модуля - сброс правил SSH и отключение UFW<:>./utils/rollback.sh
rollback::orchestrator::ufw()<:>Orchestrator<:>Простой откат для UFW модуля - только отключение UFW<:>./utils/rollback.sh
rollback::orchestrator::full()<:>Orchestrator<:>Полная очистка системы от следов BSSS и деактивация UFW.<:>./utils/rollback.sh
rollback::orchestrator::watchdog_timer()<:>Orchestrator<:>Таймер для автоматического отката<:>./utils/rollback.sh
main()<:>Orchestrator<:>Основная точка входа<:>./utils/rollback.sh
