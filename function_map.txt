function_name|type|description|file_path|call_count
runner::module::run_check()|Orchestrator|Поиск и запуск модулей с типом 'check'|./bsss-main.sh|2
runner::module::select_modify()|Filter|Отображает нумерованное меню модулей для выбора|./bsss-main.sh|1
runner::module::run_modify()|Orchestrator|Поиск и запуск модулей с типом 'modify' в циклическом меню|./bsss-main.sh|1
main()|Orchestrator|Основная точка входа|./bsss-main.sh|16
main()|Orchestrator|Создает архив проекта|./build-archive.sh|16
log::new_line()|Sink|Новая строка|./lib/logging.sh|2
log_success()|Sink|Выводит успешное сообщение с символом [v]|./lib/logging.sh|6
log_error()|Sink|Выводит сообщение об ошибке с символом [x]|./lib/logging.sh|47
log_info()|Sink|Выводит информационное сообщение с символом [ ]|./lib/logging.sh|85
log_debug()|Sink|Выводит информационное сообщение с символом [ ]|./lib/logging.sh|0
log_bold_info()|Sink|Выводит информационное сообщение с символом [ ]|./lib/logging.sh|4
log_warn()|Sink|Выводит предупреждение с символом [!]|./lib/logging.sh|5
log_attention()|Sink|Выводит важное сообщение с символом [A]|./lib/logging.sh|4
log_actual_info()|Sink|Выводит важное сообщение с символом [i]|./lib/logging.sh|5
log_info_simple_tab()|Sink|Выводит информационное сообщение с отступом|./lib/logging.sh|12
log_start()|Sink|Выводит информационное сообщение о запуске процесса|./lib/logging.sh|5
log_stop()|Sink|Выводит информационное сообщение о остановке процесса|./lib/logging.sh|4
log::draw_border()|Sink|Выводит разделитель из 80 символов '#'|./lib/logging.sh|4
log::draw_lite_border()|Sink|Выводит разделитель из 80 символов '-'|./lib/logging.sh|11
check_uninstall_file()|Filter|Проверяет наличие файла с путями для удаления|./lib/uninstall_functions.sh|1
do_uninstall()|Orchestrator|Выполняет удаление файлов из файла лога|./lib/uninstall_functions.sh|1
run_uninstall()|Orchestrator|Запускает процесс удаления с подтверждением|./lib/uninstall_functions.sh|1
io::ask_value()|Interactive|Циклический опрос пользователя до получения валидного значения.|./lib/user_confirmation.sh|7
io::confirm_action()|Validator|Ждет подтверждение действия. Доступны только y или n|./lib/user_confirmation.sh|7
parse_params()|Filter|Парсинг параметров запуска с использованием getopts|./local-runner.sh|1
check_permissions()|Filter|Проверяет права доступа для запуска скрипта|./local-runner.sh|1
show_help()|Sink|Выводит справочную информацию|./local-runner.sh|1
run_default()|Orchestrator|Запускает основной скрипт|./local-runner.sh|1
main()|Orchestrator|Основная точка входа|./local-runner.sh|16
sys::log::rotate_old_files()|Sink|Вращает лог-файлы - удаляет старые файлы если их больше MAX_LOG_FILES|./modules/helpers/common.sh|1
sys::file::get_paths_by_mask()|Source|Получает список путей через нулевой разделитель|./modules/helpers/common.sh|5
sys::module::get_paths_w_type|Filter|Возвращает строку - путь с типом и порядком запуска|./modules/helpers/common.sh|4
sys::module::get_by_type|Filter|Возвращает отфильтрованные по типу пути к модулям|./modules/helpers/common.sh|3
sys::module::sort_by_order()|Filter|Сортирует пути модулей по приоритету MODULE_ORDER и извлекает только пути|./modules/helpers/common.sh|2
sys::module::validate_order()|Source|Валидирует наличие обязательного метатега MODULE_ORDER во всех модулях с MODULE_TYPE|./modules/helpers/common.sh|1
sys::module::check_duplicate_order()|Source|Проверяет дубликаты значений MODULE_ORDER в модулях|./modules/helpers/common.sh|1
sys::file::delete()|Filter|Удаляет указанные файлы и директории|./modules/helpers/common.sh|5
ssh::port::get_from_ss()|Source|Получает активные SSH порты из ss|./modules/helpers/common.sh|2
ssh::port::get_first_from_path()|Filter|Получает первый порт из path|./modules/helpers/common.sh|0
ssh::log::active_ports_from_ss()|Orchestrator|Проверяет возможность определения активных портов|./modules/helpers/common.sh|3
ufw::log::rules()|Orchestrator|Выводит активные правила UFW|./modules/helpers/common.sh|2
ufw::rule::reset_and_pass()|Filter|Удаляет все правила UFW BSSS и передает порт дальше|./modules/helpers/common.sh|2
ufw::rule::delete_all_bsss()|Orchestrator|Удаляет все правила UFW BSSS|./modules/helpers/common.sh|2
ufw::rule::get_all_bsss()|Source|Получает все правила UFW BSSS|./modules/helpers/common.sh|2
ufw::rule::get_all()|Source|Получает все правила UFW|./modules/helpers/common.sh|1
ufw::rule::add_bsss()|Filter|Добавляет правило UFW для BSSS|./modules/helpers/common.sh|1
ufw::status::is_active()|Filter|Проверяет, активен ли UFW|./modules/helpers/common.sh|5
ufw::status::force_disable()|Filter|Деактивирует UFW (пропускает если уже деактивирован)|./modules/helpers/common.sh|4
rollback::orchestrator::watchdog_start()|Orchestrator|Запускает фоновый процесс rollback (watchdog)|./modules/helpers/common.sh|2
rollback::orchestrator::watchdog_stop()|Orchestrator|Останавливает процесс rollback (watchdog) по PID|./modules/helpers/common.sh|2
make_fifo_and_start_reader()|Orchestrator|Создает FIFO и запускает слушатель для коммуникации с rollback|./modules/helpers/common.sh|2
common::rollback::stop_script_by_rollback_timer()|Orchestrator|Обработчик сигнала SIGUSR1 - останавливает модуль при откате и удаляем fifo|./modules/helpers/common.sh|2
common::exit::actions()|Orchestrator|Обработчик сигнала EXIT - останавливает модуль и удаляем fifo|./modules/helpers/common.sh|2
ssh::menu::display_exists_scenario()|Sink|Отображает меню сценария с существующими конфигами|./modules/helpers/ssh-port.sh|1
ssh::menu::display_install_ui()|Sink|Отображает меню сценария установки|./modules/helpers/ssh-port.sh|1
ssh::port::install_new()|Filter|Основной функционал установки/изменения SSH порта|./modules/helpers/ssh-port.sh|1
ssh::ui::get_new_port()|Source|Запрашивает у пользователя новый SSH порт|./modules/helpers/ssh-port.sh|1
ssh::log::bsss_configs()|Sink|Логирует все BSSS конфигурации SSH с портами|./modules/helpers/ssh-port.sh|3
ssh::log::other_configs()|Sink|Логирует все сторонние конфигурации SSH с портами|./modules/helpers/ssh-port.sh|1
ssh::orchestrator::log_statuses()|Orchestrator|Выполняет действия после установки порта: перезапуск сервисов и валидация|./modules/helpers/ssh-port.sh|3
ssh::rule::reset_and_pass()|Filter|Удаляет все правила BSSS и передает порт дальше|./modules/helpers/ssh-port.sh|2
ssh::rule::delete_all_bsss()|Orchestrator|Удаляет все правила BSSS SSH|./modules/helpers/ssh-port.sh|2
ssh::port::is_port_free()|Source|Проверяет, что указанный порт свободен|./modules/helpers/ssh-port.sh|2
ssh::port::generate_free_random_port()|Source|Генерирует случайный свободный порт в диапазоне 10000-65535|./modules/helpers/ssh-port.sh|1
ssh::config::create_bsss_file()|Filter|Создает новый конфигурационный файл SSH с указанным портом|./modules/helpers/ssh-port.sh|1
ssh::port::wait_for_up()|Filter|Блокирующая проверка поднятия SSH порта после изменения|./modules/helpers/ssh-port.sh|1
ssh::orchestrator::config_exists_handler()|Orchestrator|Обработчик сценария с существующими конфигами|./modules/helpers/ssh-port.sh|1
ssh::orchestrator::config_not_exists_handler()|Orchestrator|Обработчик сценария отсутствия конфигов|./modules/helpers/ssh-port.sh|1
ssh::install::port()|Orchestrator|Устанавливает новый SSH порт с механизмом rollback|./modules/helpers/ssh-port.sh|2
ssh::reset::port()|Orchestrator|Сбрасывает SSH порт (удаляет все BSSS правила)|./modules/helpers/ssh-port.sh|1
ssh::log::guard_instructions()|Sink|Отображает инструкции guard для пользователя|./modules/helpers/ssh-port.sh|1
sys::service::restart()|Orchestrator|Перезапускает SSH сервис после проверки конфигурации|./modules/helpers/ssh-port.sh|3
ssh::socket::is_already_configured()|Filter|Проверяет, настроен ли SSH в service mode|./modules/helpers/ssh-socket.sh|1
ssh::socket::force_service_mode()|Orchestrator|Принудительно переключает SSH в service mode|./modules/helpers/ssh-socket.sh|1
ufw::rule::has_any_bsss()|Filter|Проверяет, есть ли правила UFW BSSS|./modules/helpers/ufw.sh|1
ufw::rule::check_requirements()|Orchestrator|Проверяет требования для запуска UFW модуля|./modules/helpers/ufw.sh|1
ufw::menu::get_items()|Source|Генерирует список доступных пунктов меню на основе текущего состояния|./modules/helpers/ufw.sh|2
ufw::menu::display()|Sink|Отображает пункты меню пользователю (вывод только в stderr)|./modules/helpers/ufw.sh|1
ufw::menu::count_items()|Source|Считает количество пунктов меню (Корректно работает до 9 пунктов)|./modules/helpers/ufw.sh|1
ufw::menu::get_user_choice()|Source|Запрашивает выбор пользователя и возвращает выбранный ID|./modules/helpers/ufw.sh|1
ufw::orchestrator::dispatch_logic()|Orchestrator|Применяет изменения UFW на основе выбранного действия|./modules/helpers/ufw.sh|1
ufw::toggle::status()|Orchestrator|Переключает состояние UFW|./modules/helpers/ufw.sh|1
ufw::status::force_enable()|Orchestrator|Активирует UFW с watchdog и подтверждением подключения|./modules/helpers/ufw.sh|1
log::rollback::instructions()|Sink|Отображает инструкции пользователю для проверки подключения|./modules/helpers/ufw.sh|1
ufw::toggle::ping()|Orchestrator|Переключает состояние PING|./modules/helpers/ufw.sh|1
ufw::orchestrator::disable_ping()|Orchestrator|Отключает пинг через UFW (бэкап + трансформация + reload)|./modules/helpers/ufw.sh|1
ufw::log::status()|Sink|Логирует состояние UFW|./modules/helpers/ufw.sh|1
ufw::log::ping_status()|Sink|Логирует состояние PING|./modules/helpers/ufw.sh|1
ufw::orchestrator::log_statuses()|Orchestrator|Отображает статусы UFW: общее состояние, правила, состояние PING|./modules/helpers/ufw.sh|5
ufw::ping::is_configured()|Filter|Проверяет, существует ли бэкап файл настроек PING|./modules/helpers/ufw.sh|3
ufw::ping::backup_file()|Filter|Создает бэкап файла before.rules|./modules/helpers/ufw.sh|1
ufw::ping::disable_in_rules()|Transformer|Заменяет ACCEPT на DROP в ICMP правилах через|./modules/helpers/ufw.sh|1
ufw::ping::restore()|Filter|Восстанавливает файл before.rules из бэкапа и удаляет бэкап|./modules/helpers/ufw.sh|1
ufw::status::reload()|Sink|Выполняет ufw reload для применения изменений|./modules/helpers/ufw.sh|1
get_os_id()|Filter|Получает строку ID текущей системы|./modules/os-check.sh|1
check()|Orchestrator|Проверяет совместимость текущей ОС с разрешенной|./modules/os-check.sh|6
main()|NO_CONTRACT|Функция без контракта|./modules/os-check.sh|16
check()|Orchestrator|Проверяет состояние SSH портов и правил|./modules/ssh-port-check.sh|6
main()|NO_CONTRACT|Функция без контракта|./modules/ssh-port-check.sh|16
ssh::orchestrator::dispatch_logic()|Orchestrator|Определяет состояние конфигурации SSH и переключает логику модуля на соответствующий сценарий|./modules/ssh-port-modify.sh|1
main()|Orchestrator|Основная точка входа для модуля изменения SSH порта|./modules/ssh-port-modify.sh|16
check()|Orchestrator|Настраивает SSH в service режим, если это необходимо|./modules/ssh-socket-check.sh|6
main()|NO_CONTRACT|Функция без контракта|./modules/ssh-socket-check.sh|16
check()|Orchestrator|Проверяет необходимость перезагрузки системы|./modules/system-reload-check.sh|6
main()|NO_CONTRACT|Функция без контракта|./modules/system-reload-check.sh|16
sys::update::get_command()|Source|Генерирует команду обновления системы для apt|./modules/system-update.sh|1
sys::update::execute()|Sink|Выполняет обновление системы используя переданную команду|./modules/system-update.sh|1
sys::update::orchestrator()|Orchestrator|Оркестратор процесса обновления системы|./modules/system-update.sh|1
main()|Orchestrator|Основная точка входа модуля обновления системы|./modules/system-update.sh|16
check()|Orchestrator|Проверяет наличие UFW и устанавливает при необходимости|./modules/ufw-check.sh|6
main()|NO_CONTRACT|Функция без контракта|./modules/ufw-check.sh|16
ufw::orchestrator::run_module()|Orchestrator|Запускает модуль UFW с механизмом rollback только при включении UFW|./modules/ufw-modify.sh|1
main()|Orchestrator|Основная точка входа для модуля изменения состояния UFW|./modules/ufw-modify.sh|16
is_sourced()|Filter|Проверяет, был ли скрипт вызван через source|./oneline-runner.sh|1
log_success()|Sink|Выводит успешное сообщение с символом [V]|./oneline-runner.sh|6
log_error()|Sink|Выводит сообщение об ошибке с символом [X]|./oneline-runner.sh|47
log_info()|Sink|Выводит информационное сообщение с символом [ ]|./oneline-runner.sh|85
cleanup_handler()|Orchestrator|Очистка временных файлов|./oneline-runner.sh|2
hello()|Sink|Выводит приветственное сообщение|./oneline-runner.sh|1
check_root_permissions()|Filter|Проверяет права root|./oneline-runner.sh|1
ask_user_how_to_run()|NO_CONTRACT|Функция без контракта|./oneline-runner.sh|1
_create_tmp_dir()|Source|Создаёт временную директорию|./oneline-runner.sh|1
_download_archive()|Source|Скачивает архив во временный файл|./oneline-runner.sh|1
_unpack_archive()|Filter|Распаковывает архив|./oneline-runner.sh|1
_check_archive_unpacking()|Filter|Проверяет успешность распаковки во временную директорию|./oneline-runner.sh|1
_add_uninstall_path()|Sink|Добавляет путь в файл лога установки для последующего удаления|./oneline-runner.sh|2
_check_symlink_exists()|Filter|Проверяет наличие символической ссылки|./oneline-runner.sh|1
_create_install_directory()|Orchestrator|Создание директории установки|./oneline-runner.sh|1
_copy_installation_files()|Orchestrator|Копирование файлов установки|./oneline-runner.sh|1
_create_symlink()|Orchestrator|Создание символической ссылки|./oneline-runner.sh|1
_set_execution_permissions()|Orchestrator|Установка прав на выполнение|./oneline-runner.sh|1
install_to_system()|Orchestrator|Функция установки в систему|./oneline-runner.sh|1
main()|Orchestrator|Основная точка входа|./oneline-runner.sh|16
find_bash_files()|Source|Находит все bash файлы в проекте|./utils/generate_function_map.sh|1
extract_functions_from_file()|Filter|Извлекает функции и их контракты из bash файла|./utils/generate_function_map.sh|1
count_function_calls()|Filter|Подсчитывает количество вызовов каждой функции|./utils/generate_function_map.sh|1
main()|Orchestrator|Основная точка входа для генерации карты функций|./utils/generate_function_map.sh|16
rollback::orchestrator::stop()|Orchestrator|Останавливает процесс таймера отката и завершает скрипт|./utils/rollback.sh|1
rollback::orchestrator::immediate()|Orchestrator|Немедленно выполняет тотальный откат при получении SIGUSR2|./utils/rollback.sh|2
rollback::orchestrator::ssh()|Orchestrator|Полный откат для SSH модуля - сброс правил SSH и отключение UFW|./utils/rollback.sh|1
rollback::orchestrator::ufw()|Orchestrator|Простой откат для UFW модуля - только отключение UFW|./utils/rollback.sh|1
rollback::orchestrator::full()|Orchestrator|Полная очистка системы от следов BSSS и деактивация UFW.|./utils/rollback.sh|2
rollback::orchestrator::watchdog_timer()|Orchestrator|Таймер для автоматического отката|./utils/rollback.sh|1
main()|Orchestrator|Основная точка входа|./utils/rollback.sh|16
